<!doctype html>
<html lang="en">
   
<!-- Mirrored from iqonic.design/themes/xray/html/app/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 01 Jul 2021 07:41:25 GMT -->
<head>
      <!-- Required meta tags -->
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      <title>Anointed Communications College | My Inbox</title>
      <!-- Favicon -->
      <link rel="shortcut icon" href="../../../static/patients/static/favicons/favicon.png" />
      <!-- Bootstrap CSS -->
      <link rel="stylesheet" href="../../../static/patients2/css/bootstrap.min.css">
      <!-- Typography CSS -->
      <link rel="stylesheet" href="../../../static/patients2/css/typography.css">
      <!-- Style CSS -->
      <link rel="stylesheet" href="../../../static/patients2/css/style.css">
      <!-- Responsive CSS -->
      <link rel="stylesheet" href="../../../static/patients2/css/responsive.css">
   </head>
   <body>
      <!-- loader Start -->
      <div id="loading">
         <div id="loading-center">
         </div>
      </div>
      <!-- loader END -->
      <!-- Wrapper Start -->
      <div class="wrapper">
      <!-- Sidebar  -->
      {% include 'patients2/workernav.html' %}

      <!-- Page Content  -->
      <div id="content-page" class="content-page">
         <!-- TOP Nav Bar -->
          {% include 'patients2/workertopnav.html' %}
         <!-- TOP Nav Bar END -->
         <div class="container-fluid relative">
            <div class="row">
               <div class="col-lg-3" style="position: sticky !important; top: 2rem;">
                  <div class="iq-card">
                     <div class="iq-card-body">
                        <div class="">
                           <div class="iq-email-list" >
                              <button class="btn btn-primary btn-lg btn-block mb-3 font-size-16 p-3" data-target="#compose-email-popup" data-toggle="modal"><i class="ri-send-plane-line mr-2"></i>New Message</button>
                              <div class="iq-email-ui nav flex-column nav-pills">
                                 <li class="nav-link active" role="tab" data-toggle="pill" href="#mail-inbox"><a href="index.html"><i class="ri-mail-line"></i>Inbox<span id="count" class="badge badge-primary ml-2">{{unreads.count()}}</span></a></li>
                                 <li class="nav-link" role="tab" data-toggle="pill" href="#mail-sent"><a href="#"><i class="ri-mail-send-line"></i>Sent Mail</a></li>
                                 <li class="nav-link" role="tab" data-toggle="pill" href="#mail-trash"><a href="#"><i class="ri-delete-bin-line"></i>Trash</a></li>
                                
                              </div>
                           
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="col-lg-9 mail-box-detail">
                  <div class="iq-card">
                     <div class="iq-card-body p-0">
                        <div class="">
                           <div class="iq-email-to-list p-3">
                              <div class="d-flex justify-content-between">
                                 <ul>
                                    <li>
                                    </li>
                                    <li data-toggle="tooltip" data-placement="top" title="Reload"><a href=""><i class="ri-restart-line"></i></a></li>
                                   
                                    <li class="iq-full-screen" data-toggle="tooltip" data-placement="top" title="Zoom"><a href="#"><i class="ri-drag-move-2-line"></i></a></li>
                                 </ul>
                                 
                              </div>
                           </div>
                           
                           
                           <div class="iq-email-listbox">
                              <div class="tab-content">
                                 <div class="tab-pane fade show active" id="mail-inbox" role="tabpanel">
                                    <ul class="iq-email-sender-list">

                                       {% for message in messages %}
                                       <li data-id="{{message['messageId']}}" {% if message['hasRead'] == False %} class="iq-unread" {% endif %}>
                                          <div class="d-flex align-self-center">
                                             <div class="iq-email-sender-info">
                                                
                                                <span class="ri-question-answer-line iq-star-toggle"></span>
                                                <a href="javascript: void(0);" class="iq-email-title"> {{message['senderName']}}</a>
                                             </div>
                                             <div class="iq-email-content">
                                                <a href="javascript: void(0);" class="iq-email-subject">{{message['message']}} &nbsp;â€“&nbsp;
                                                <span></span>
                                                </a>
                                                <!-- <div class="iq-email-date">08:00 am</div> -->
                                             </div>
                                             <ul class="iq-social-media">
                                                <!-- <li><a href="#"><i class="ri-delete-bin-2-line"></i></a></li> -->
                                                <!-- <li><a href="#"><i class="ri-mail-line"></i></a></li>
                                                <li><a href="#"><i class="ri-file-list-2-line"></i></a></li>
                                                <li><a href="#"><i class="ri-time-line"></i></a></li> -->
                                             </ul>
                                          </div>
                                       </li>
                                       <div class="email-app-details">
                                          <div class="iq-card">
                                             <div class="iq-card-body p-0">
                                                <div data-id="{{message['messageId']}}">
                                                   <div class="iq-email-to-list p-3">
                                                      <div class="d-flex justify-content-between">
                                                         <ul>
                                                            <li class="mr-3">
                                                               <a href="javascript: void(0);">
                                                                  <h4 class="m-0"><i class="ri-arrow-left-line"></i></h4>
                                                               </a>
                                                            </li>
                                                           
                                                            <!-- <li data-toggle="tooltip" data-placement="top" title="Delete"><a href="#"><i class="ri-delete-bin-line"></i></a></li>
                                                            <li data-toggle="tooltip" data-placement="top" title="Unread"><a href="#"><i class="ri-mail-unread-line"></i></a></li> -->
                                                           
                                                         </ul>
                                                         
                                                      </div>
                                                   </div>
                                                   <hr class="mt-0">
                                                   <div class="iq-inbox-subject p-3">
                                                      <h5 class="mt-0">{{message['title']}}</h5>
                                                      <div class="iq-inbox-subject-info">
                                                         <div class="iq-subject-info">
                                                            <!-- <img src="../../../static/patients2/images/user/09.png" class="img-fluid rounded-circle" alt="#"> -->
                                                            <div class="iq-subject-status align-self-center">
                                                               <h6 class="mb-0">{{message['sennderName']}}</h6>
                                                               <div class="dropdown">
                                                                  <a class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                                  to Me
                                                                  </a>
                                                                 
                                                               </div>
                                                            </div>
                                                            <span class="float-right align-self-center">{{ message['dateSent'].strftime("%b %d, %Y - %I:%M %p") }}</span>
                                                         </div>
                                                         <div class="iq-inbox-body mt-5">
                                                            <p>Hello {{user['fname']}}, </p>
                                                            <p>{{message['message']}}</p>
                                                            <!-- <p>Various versions have evolved over the years, sometimes by accident, sometimes on purpose (injected humour and the like).</p>
                                                            <p class="mt-5 mb-0">Regards,<span class="d-inline-block w-100">John Deo</span></p> -->
                                                         {% if message['messageType'] == 'request' %} 
                                                         <a href="/workers/patients/records/?id={{message['senderId']}}" class="btn btn-primary mr-2">
                                                            Access Records Now
                                                         </a>
                                                         {% endif %}
                                                         </div>
                                                         <hr>
                                                        
                                                      </div>
                                                   </div>
                                                </div>
                                             </div>
                                          </div>
                                       </div>
                                       {% endfor %}
                                    </ul>
                                 </div>
                                  <div class="tab-pane fade" id="mail-sent" role="tabpanel">
                                    <ul class="iq-email-sender-list">

                                       {% for sent in sents %}
                                       <li data-id="{{sent['messageId']}}" >
                                          <div class="d-flex align-self-center">
                                             <div class="iq-email-sender-info">
                                                
                                                <span class="ri-question-answer-line iq-star-toggle"></span>
                                                <a href="javascript: void(0);" class="iq-email-title"> {{sent['senderName']}}</a>
                                             </div>
                                             <div class="iq-email-content">
                                                <a href="javascript: void(0);" class="iq-email-subject">{{sent['message']}} &nbsp;â€“&nbsp;
                                                <span></span>
                                                </a>
                                                <!-- <div class="iq-email-date">08:00 am</div> -->
                                             </div>
                                             <ul class="iq-social-media">
                                                <!-- <li><a href="#"><i class="ri-delete-bin-2-line"></i></a></li> -->
                                                <!-- <li><a href="#"><i class="ri-mail-line"></i></a></li>
                                                <li><a href="#"><i class="ri-file-list-2-line"></i></a></li>
                                                <li><a href="#"><i class="ri-time-line"></i></a></li> -->
                                             </ul>
                                          </div>
                                       </li>
                                       <div class="email-app-details">
                                          <div class="iq-card">
                                             <div class="iq-card-body p-0">
                                                <div data-id="{{sent['messageId']}}" class="expand">
                                                   <div class="iq-email-to-list p-3">
                                                      <div class="d-flex justify-content-between">
                                                         <ul>
                                                            <li class="mr-3">
                                                               <a href="javascript: void(0);">
                                                                  <h4 class="m-0"><i class="ri-arrow-left-line"></i></h4>
                                                               </a>
                                                            </li>
                                                           
                                                            <li data-toggle="tooltip" data-placement="top" title="Delete"><a href="/workers/inbox/delete/?id={{sent['messageId']}}"><i class="ri-delete-bin-line"></i></a></li>
                                                            <!-- <li data-toggle="tooltip" data-placement="top" title="Unread"><a href="#"><i class="ri-mail-unread-line"></i></a></li> -->
                                                         </ul>
                                                         
                                                      </div>
                                                   </div>
                                                   <hr class="mt-0">
                                                   <div class="iq-inbox-subject p-3">
                                                      <h5 class="mt-0">{{sent['title']}}</h5>
                                                      <div class="iq-inbox-subject-info">
                                                         <div class="iq-subject-info">
                                                            <!-- <img src="../../../static/patients2/images/user/05.jpg" class="img-fluid rounded-circle" alt="#"> -->
                                                            <div class="iq-subject-status align-self-center">
                                                               <h6 class="mb-0">{{sent['sennderName']}}</h6>
                                                               <div class="dropdown">
                                                                  <!-- <a class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                                  to Me
                                                                  </a>
                                                                  -->
                                                               </div>
                                                            </div>
                                                            <span class="float-right align-self-center">{{ sent['dateSent'].strftime("%b %d, %Y - %I:%M %p") }}</span>
                                                         </div>
                                                         <div class="iq-inbox-body mt-5">
                                                            <p>Hello, </p>
                                                            <p>{{sent['message']}}</p>
                                                            <!-- <p>Various versions have evolved over the years, sometimes by accident, sometimes on purpose (injected humour and the like).</p>
                                                            <p class="mt-5 mb-0">Regards,<span class="d-inline-block w-100">John Deo</span></p> -->
                                                         </div>
                                                         <hr>
                                                        
                                                      </div>
                                                   </div>
                                                </div>
                                             </div>
                                          </div>
                                       </div>
                                       {% endfor %}
                                    </ul>
                                 </div>
                                 <div class="tab-pane fade" id="mail-trash" role="tabpanel">
                                    <ul class="iq-email-sender-list">

                                       {% for trash in trashed %}
                                       <li data-id="{{trash['messageId']}}" >
                                          <div class="d-flex align-self-center">
                                             <div class="iq-email-sender-info">
                                                
                                                <span class="ri-question-answer-line iq-star-toggle"></span>
                                                <a href="javascript: void(0);" class="iq-email-title"> {{trash['senderName']}}</a>
                                             </div>
                                             <div class="iq-email-content">
                                                <a href="javascript: void(0);" class="iq-email-subject">{{trash['message']}} &nbsp;â€“&nbsp;
                                                <span></span>
                                                </a>
                                                <!-- <div class="iq-email-date">08:00 am</div> -->
                                             </div>
                                             <ul class="iq-social-media">
                                                <!-- <li><a href="#"><i class="ri-delete-bin-2-line"></i></a></li> -->
                                                <!-- <li><a href="#"><i class="ri-mail-line"></i></a></li>
                                                <li><a href="#"><i class="ri-file-list-2-line"></i></a></li>
                                                <li><a href="#"><i class="ri-time-line"></i></a></li> -->
                                             </ul>
                                          </div>
                                       </li>
                                       <div class="email-app-details">
                                          <div class="iq-card">
                                             <div class="iq-card-body p-0">
                                                <div data-id="{{trash['messageId']}}" class="expand">
                                                   <div class="iq-email-to-list p-3">
                                                      <div class="d-flex justify-content-between">
                                                         <ul>
                                                            <li class="mr-3">
                                                               <a href="javascript: void(0);">
                                                                  <h4 class="m-0"><i class="ri-arrow-left-line"></i></h4>
                                                               </a>
                                                            </li>
                                                           
                                                            <!-- <li data-toggle="tooltip" data-placement="top" title="Delete"><a href="#"><i class="ri-delete-bin-line"></i></a></li> -->
                                                            <!-- <li data-toggle="tooltip" data-placement="top" title="Unread"><a href="#"><i class="ri-mail-unread-line"></i></a></li> -->
                                                         </ul>
                                                         
                                                      </div>
                                                   </div>
                                                   <hr class="mt-0">
                                                   <div class="iq-inbox-subject p-3">
                                                      <h5 class="mt-0">{{trash['title']}}</h5>
                                                      <div class="iq-inbox-subject-info">
                                                         <div class="iq-subject-info">
                                                            <!-- <img src="../../../static/patients2/images/user/05.jpg" class="img-fluid rounded-circle" alt="#"> -->
                                                            <div class="iq-subject-status align-self-center">
                                                               <h6 class="mb-0">{{trash['sennderName']}}</h6>
                                                               <div class="dropdown">
                                                                  <!-- <a class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                                  to Me
                                                                  </a> -->
                                                                 
                                                               </div>
                                                            </div>
                                                            <span class="float-right align-self-center">{{ trash['dateSent'].strftime("%b %d, %Y - %I:%M %p") }}</span>
                                                         </div>
                                                         <div class="iq-inbox-body mt-5">
                                                            <p>Hello, </p>
                                                            <p>{{trash['message']}}</p>
                                                            <!-- <p>Various versions have evolved over the years, sometimes by accident, sometimes on purpose (injected humour and the like).</p>
                                                            <p class="mt-5 mb-0">Regards,<span class="d-inline-block w-100">John Deo</span></p> -->
                                                         </div>
                                                         <hr>
                                                        
                                                      </div>
                                                   </div>
                                                </div>
                                             </div>
                                          </div>
                                       </div>
                                       {% endfor %}
                                    </ul>
                                 </div>
                              </div>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
               <div id="compose-email-popup" class="compose-popup modal modal-sticky-bottom-right modal-sticky-lg">
                  <div class="iq-card iq-border-radius-20 mb-0">
                     <div class="iq-card-body">
                        <div class="row align-items-center">
                           <div class="col-md-12 mb-3">
                              <h5 class="text-primary float-left"><i class="ri-pencil-fill"></i> Compose Message</h5>
                              <button type="submit" class="float-right close-popup" data-dismiss="modal"><i class="ri-close-fill"></i></button>
                           </div>
                        </div>
                        <form action="{{url}}" class="email-form" method="POST" >
                           <div class="form-group row">
                              <label for="inputEmail3" class="col-sm-2 col-form-label">To:</label>
                              <div class="col-sm-10">
                                 <select name="receiver" required  id="inputEmail3" class="form-control" >
                                     {% for admin in admins %}
                                       <option value="{{admin['public_id']}}">
                                       Hospital Admin
                                       </option>
                                    {% endfor %}
                                     {% for patient in patients %}
                                       <option value="{{patient['public_id']}}">
                                       patient... {{patient['name']}}
                                       </option>
                                    {% endfor %}
                                    {% for worker in workers %}
                                       <option value="{{worker['public_id']}}">
                                       {{worker['role']}}... {{worker['fname']}}
                                       {{worker['lname']}}
                                       </option>
                                    {% endfor %}
                                 </select>
                              </div>
                           </div>
                           <!-- <div class="form-group row">
                              <label for="cc" class="col-sm-2 col-form-label">Cc:</label>
                              <div class="col-sm-10">
                                 <select  id="cc" class="select2jsMultiSelect form-control" multiple="multiple">
                                    <option value="Brock Lee">Brock Lee</option>
                                    <option value="Rick O'Shea">Rick O'Shea</option>
                                    <option value="Cliff Hanger">Cliff Hanger</option>
                                    <option value="Barb Dwyer">Barb Dwyer</option>
                                 </select>
                              </div>
                           </div> -->
                           <div class="form-group row">
                              <label for="subject" class="col-sm-2 col-form-label">Subject:</label>
                              <div class="col-sm-10">
                                 <input  name="title" required placeholder="Why are you messaging...?" type="text"  id="subject" class="form-control">
                              </div>
                           </div>
                           <div class="form-group row">
                              <label for="subject" class="col-sm-2 col-form-label">Your Message:</label>
                              <div class="col-md-10">
                                 <textarea required name="message" placeholder="Your message goes here..." class="textarea form-control" rows="5"></textarea>
                              </div>
                           </div>
                           <div class="form-group row align-items-center compose-bottom pt-3 m-0">
                              <div class="d-flex flex-grow-1 align-items-center">
                                 <div class="send-btn">
                                    <button type="submit" class="btn btn-primary">Send</button>
                                 </div>
                                 
                              </div>
                             
                           </div>
                        </form>
                     </div>
                  </div>
               </div>
            </div>
         </div>
         <!-- Footer -->
         {% include 'patients2/patientfooter.html' %}
      </div>

      <script>

         const messages = document.querySelectorAll('.iq-unread')
         const count = document.querySelector('#count')

         messages.forEach(message =>{

            message.onclick = async function (){
            const id = message.dataset.id

                     url =
                  window.location.origin +
                  `/workers/inbox/markAsRead/?id=${id}`;

               const request = await fetch(url, {
                  method: 'POST',
                  headers: {
                     'Content-Type': 'application/json',
                  },
                 // body: JSON.stringify(body),
               });

               const response = await request.json();

       

               if (request.ok) {
                  if (response.status === true) {
                     message.classList.remove('iq-unread')
                     if(count.innerText != '0'){
                         count.innerText = parseInt(count.innerText) - 1
                     }
                     return
                  } else {
                     return
                  }
               } else {
                 return
               }
         }

         })

      </script>
      <!-- Wrapper END -->
      <!-- Footer END -->
      <!-- Optional JavaScript -->
      <!-- jQuery first, then Popper.js, then Bootstrap JS -->
      <script data-cfasync="false" src="../../../static/patients2/../../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script src="../../../static/patients2/js/jquery.min.js"></script>
      <script src="../../../static/patients2/js/popper.min.js"></script>
      <script src="../../../static/patients2/js/bootstrap.min.js"></script>
      <!-- Appear JavaScript -->
      <script src="../../../static/patients2/js/jquery.appear.js"></script>
      <!-- Countdown JavaScript -->
      <script src="../../../static/patients2/js/countdown.min.js"></script>
      <!-- Counterup JavaScript -->
      <script src="../../../static/patients2/js/waypoints.min.js"></script>
      <script src="../../../static/patients2/js/jquery.counterup.min.js"></script>
      <!-- Wow JavaScript -->
      <script src="../../../static/patients2/js/wow.min.js"></script>
      <!-- Apexcharts JavaScript -->
      <script src="../../../static/patients2/js/apexcharts.js"></script>
      <!-- Slick JavaScript -->
      <script src="../../../static/patients2/js/slick.min.js"></script>
      <!-- Select2 JavaScript -->
      <script src="../../../static/patients2/js/select2.min.js"></script>
      <!-- Owl Carousel JavaScript -->
      <script src="../../../static/patients2/js/owl.carousel.min.js"></script>
      <!-- Magnific Popup JavaScript -->
      <script src="../../../static/patients2/js/jquery.magnific-popup.min.js"></script>
      <!-- Smooth S../crollbar JavaScript -->
      <script src="../../../static/patients2/js/smooth-scrollbar.js"></script>
      <!-- lottie JavaScript -->
      <script src="../../../static/patients2/js/lottie.js"></script>
      <!-- Chart Custom JavaScript -->
      <script src="../../../static/patients2/js/chart-custom.js"></script>
      <!-- Custom JavaScript -->
      <script src="../../../static/patients2/js/custom.js"></script>
   </body>

<!-- Mirrored from iqonic.design/themes/xray/html/app/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 01 Jul 2021 07:41:35 GMT -->
</html>